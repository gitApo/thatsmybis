var inputType="string",firstRun=!0,addedCount=0,skippedCount=0,overLimitCount=0,skippedItems=[],errorCount=0,firstError=void 0;function parseUpgradesImport(t){if("true"!=$(t).prop("disabled")){disableForm(),$("#status-message").html("").hide(),errorCount=0,firstError=void 0,addedCount=0,overLimitCount=0,skippedItems=[],firstRun?firstRun=!1:console.log("--------------------------------------------------"),console.log('Input accepts JSON. eg. { "items": [ { "name": "Azuresong Mageblade", "id": 17103 }, { "name": "Staff of Dominance", "id": 18842 } ] }'),console.log("Importing wishlist items...");var e=$("#importTextarea").val();if(!e)return alert("Please enter a valid JSON string. Re-copy the export from 60/70/80 upgrades.com"),enableForm(),0;var o=null;try{o=JSON.parse(e)}catch(t){console.log("Invalid JSON input."),console.log("Clearing input... Old input:",$("[name=import_textarea]").val()),clearInput(),errorCount++,firstError="Invalid input. Try again."}if(!errorCount)if(console.log(o),setTimeout(function(){},250),o.items&&o.items.length>0){for(var i=0;i<o.items.length;i++){var r=o.items[i];i>=maxItems?(overLimitCount++,skippedItems.push(r.name)):(loadItemToForm(r),addedCount++)}makeWowheadLinks()}else console.log("No items found");var a="";if(firstError&&(a+='<li class="text-danger">Error: '.concat(firstError,"</li>")),addedCount&&(a+='<li class="text-success">'.concat(addedCount," item").concat(addedCount>1?"s":""," loaded into form</li>")),overLimitCount&&(a+='<li class="text-warning">'.concat(overLimitCount?overLimitCount+" items over the limit of "+maxItems:"","</li>")),skippedItems.length){var n=skippedItems.length;skippedItems=skippedItems.join(", "),a+='<li class="text-danger">'.concat(n," item").concat(n>1?"s":""," skipped (no room): ").concat(skippedItems,"</li>")}a&&$("#status-message").html("<ul>".concat(a,"</ul>")).show(),clearInput(),setTimeout(function(){enableForm()},100)}}function clearInput(){$("[name=import_textarea]").val("")}function enableForm(){setTimeout(function(){$("#itemForm fieldset").prop("disabled",!1),$("#loading-indicator").hide(),$("#loaded-indicator").show(),setTimeout(function(){$("#submitImport").prop("disabled",!1),$(".js-toggle-import").prop("disabled",!1),$("#loaded-indicator").hide()},5e3)},1e3)}function disableForm(){$("#loading-indicator").show(),$("#submitImport").prop("disabled",!0),$("#itemForm fieldset").prop("disabled",!0),$(".js-toggle-import").prop("disabled",!0)}function loadItemToForm(t){var e=$("#wishlist");addTag(e,t.id,t.name)}$(document).ready(function(){var t=!0;warnBeforeLeaving("#itemForm"),addSortHandlers(),$(".js-toggle-import").click(function(){$("#toggleImport").toggle(),$("#importArea").toggle()}),$("[name=import_textarea]").bind("input change",function(){$(this).val()?$("#submitImport").prop("disabled",!1):$("#submitImport").prop("disabled",!0)}),$("#submitImport").click(function(){parseUpgradesImport(this)}),$(".js-toggle-note").change(function(){var t=$(this).data("index"),e=$(this).data("type");$(this).prop("checked")?$(".js-note[data-index="+t+"][data-type="+e+"]").parent().show():$(".js-note[data-index="+t+"][data-type="+e+"]").parent().hide()}),t=!1,$(".loadingBarContainer").removeClass("d-flex").hide(),$("#itemForm").show()});
